import{_ as J}from"./nuxt-link.5ccbcf4d.js";import{d as K}from"./index.44e8f268.js";/* empty css              */import{aZ as L,cL as T,aW as M,d2 as Y,a$ as Q,b1 as Z,b2 as X,aY as $,cQ as D,ce as F,a as R,r as c,o as k,c as A,H as r,N as O,n as ee,g as se,aj as te,h as i,e,t as x,G as g,I as ae,J as ie,b as z,z as I}from"./entry.92cc3846.js";import{C as H,P as oe,a as le}from"./InfoPanel.vue.0fb41274.js";import"./vue.runtime.esm-bundler.08aa84eb.js";import"./FileSaver.min.a072bdec.js";import"./CardRefresh.d37be0b0.js";import"./CardCollapse.4df3c1d4.js";const B={data:{type:Object,required:!0},options:{type:Object,default:()=>({})},plugins:{type:Array,default:()=>[]},datasetIdKey:{type:String,default:"label"},updateMode:{type:String,default:void 0}},ne={type:{type:String,required:!0},...B},re=Y[0]==="2"?(t,s)=>Object.assign(t,{attrs:s}):(t,s)=>Object.assign(t,s);function S(t){return F(t)?D(t):t}function ce(t){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:t;return F(s)?new Proxy(t,{}):t}function de(t,s){const n=t.options;n&&s&&Object.assign(n,s)}function E(t,s){t.labels=s}function W(t,s,n){const d=[];t.datasets=s.map(a=>{const o=t.datasets.find(m=>m[n]===a[n]);return!o||!a.data||d.includes(o)?{...a}:(d.push(o),Object.assign(o,a),o)})}function he(t,s){const n={labels:[],datasets:[]};return E(n,t.labels),W(n,t.datasets,s),n}const pe=L({props:ne,setup(t,s){let{expose:n}=s;const d=Q(null),a=T(null);n({chart:a});const o=()=>{if(!d.value)return;const{type:p,data:u,options:f,plugins:v,datasetIdKey:y}=t,_=he(u,y),b=ce(_,u);a.value=new H(d.value,{type:p,data:b,options:{...f},plugins:v})},m=()=>{const p=D(a.value);p&&(p.destroy(),a.value=null)},h=p=>{p.update(t.updateMode)};return Z(o),X(m),$([()=>t.options,()=>t.data],(p,u)=>{let[f,v]=p,[y,_]=u;const b=D(a.value);if(!b)return;let P=!1;if(f){const w=S(f),N=S(y);w&&w!==N&&(de(b,w),P=!0)}if(v){const w=S(v.labels),N=S(_.labels),C=S(v.datasets),V=S(_.datasets);w!==N&&(E(b.config.data,w),P=!0),C&&C!==V&&(W(b.config.data,C,t.datasetIdKey),P=!0)}P&&h(b)},{deep:!0}),()=>M("canvas",{ref:d})}});function ue(t,s){return H.register(s),L({props:B,setup(n,d){let{expose:a}=d;const o=T(null),m=h=>{o.value=h==null?void 0:h.chart};return a({chart:o}),()=>M(pe,re({ref:m},{type:t,...n}))}})}const me=ue("pie",oe),fe={extends:me,props:{data:{type:Object,default:null},options:{type:Object,default:null}},mounted(){this.renderChart(this.data,this.options)}},_e={name:"EnsoChartCard",components:{ChartCard:le},inject:["errorHandler","i18n"],data:()=>({ready:!1}),computed:{config(){return this.ready&&this.$refs.chart.config}},methods:{fetch(){this.chart&&this.chart.fetch()},resize(){this.chart||this.chart.resize()}}};function ve(t,s,n,d,a,o){const m=c("chart-card");return k(),A(m,{i18n:o.i18n,"error-handler":o.errorHandler,onFetched:s[0]||(s[0]=h=>t.ready=!0),ref:"chart"},{controls:r(()=>[O(t.$slots,"controls")]),default:r(h=>[O(t.$slots,"default",ee(se(h)))]),_:3},8,["i18n","error-handler"])}const ge=R(_e,[["render",ve]]),be=""+new URL("gedcom.36d26a4a.svg",import.meta.url).href,xe=""+new URL("families.94c3018c.svg",import.meta.url).href,ye=""+new URL("peoples.7561a037.svg",import.meta.url).href,we={layout:"auth",components:{Loading:K.Loading,PieChart:fe,ChartCard:ge},inject:["errorHandler","route","toastr"],meta:{permission:{name:"dashboard menu"},title:"Dashboard"},data(){return{loaded:!1,trees:[],companies:[],invited_companies:[],selected_company:null,invited_company:null,selected_tree:null,isLoading:!1,fullPage:!0,color:"#4fcf8d",changedb:null,backgroundColor:"#ffffff",trial:null,familiesjoined:0,peoplesattached:0,pieChartData:null,chartOptions:null,apiList:["Open arch","Family search","Wikitree","Member tree"],apiSelected:"Open arch",dateMenu:!1,filter:{firstName:"",lastName:"",date:""},totalCount:0,result:null,LoadingPlugin:!0,options:{}}},computed:{...te(["loggedInUser"]),headers(){if(this.apiSelected=="Geneanum")return[{text:"ID",value:"identifier",sortable:!1},{text:"PID",value:"pid",sortable:!1},{text:"Name",value:"personname",sortable:!1},{text:"Place",value:"eventplace",sortable:!1},{text:"Type",value:"eventtype",sortable:!1},{text:"Archive",value:"archive",sortable:!1}];if(this.apiSelected=="Open arch")return[{text:"ID",value:"identifier",sortable:!1},{text:"PID",value:"pid",sortable:!1},{text:"Name",value:"personname",sortable:!1},{text:"Event Place",value:"eventplace",sortable:!1},{text:"Event Type",value:"eventtype",sortable:!1},{text:"Date",value:"eventdate.year",sortable:!1},{text:"Relation Type",value:"relationtype",sortable:!1},{text:"Source Type",value:"sourcetype",sortable:!1},{text:"Archive",value:"archive",sortable:!1},{text:"Code",value:"archive_code",sortable:!1},{text:"Org",value:"archive_org",sortable:!1}];if(this.apiSelected=="Family search")return[{text:"ID",value:"identifier",sortable:!1},{text:"PID",value:"pid",sortable:!1},{text:"Name",value:"personname",sortable:!1},{text:"Place",value:"eventplace",sortable:!1},{text:"Type",value:"eventtype",sortable:!1},{text:"Archive",value:"archive",sortable:!1}];if(this.apiSelected=="Member tree")return[{text:"ID",value:"id",sortable:!1},{text:"Name",value:"name",sortable:!1}];if(this.apiSelected=="Wikitree")return[{text:"ID",value:"identifier",sortable:!1},{text:"PID",value:"pid",sortable:!1},{text:"Name",value:"personname",sortable:!1},{text:"Place",value:"eventplace",sortable:!1},{text:"Type",value:"eventtype",sortable:!1},{text:"Archive",value:"archive",sortable:!1}]}},watch:{options:{handler(){console.log(this.loading,this.options),this.search()},deep:!1}},methods:{setSelectedCompany(t){this.selected_tree=null,this.getTree()},async setSelected(t){const s=await this.$axios.$post("/api/dashboard/changedb",{company_id:t});this.loadChart(),this.changedb=s.changedb,this.familiesjoined=s.familiesjoined,this.peoplesattached=s.peoplesattached,console.log("changedb response",s),console.log("familiesjoined",s.familiesjoined),console.log("peoplesattached",s.peoplesattached)},async getCompanies(){const t=await this.$axios.$get("/api/get_companies");this.companies=t.my_comps,this.invited_companies=t.invited_comps,this.companies.map(s=>{s.is_tenant==1&&s.email===this.loggedInUser.email&&(this.selected_company=s.id,this.getTree())})},async getTree(){this.selected_tree=null;const t=await this.$axios.$get("/api/trees/show",{params:{start_id:this.selected_company,nest:3}});this.trees=Object.values(t.persons),this.trees.map(s=>{s.current_tenant==1&&(this.selected_tree=s.id)})},async loadChart(){this.loaded=!1;const t=await this.$axios.get("/api/dashboard/pie");this.pieChartData=t.data,this.chartOptions=t.options,this.loaded=!0,this.isLoading=!1},search(){var n,d,a,o,m,h,p,u,f,v,y;this.loading=!0;let t="",s={};this.apiSelected=="Geneanum"?(t="/api/geneanum/search-person/malta/burials",s={FirstName:this.filter.firstName||"",LastName:this.filter.lastName||"",per_page:((n=this.options)==null?void 0:n.itemsPerPage)||10,page:((d=this.options)==null?void 0:d.page)||1,sidx:((a=this.options)==null?void 0:a.sidx)||100,row:((o=this.options)==null?void 0:o.row)||100}):this.apiSelected=="Open arch"?(t="/api/open-arch/search-person",s={name:(this.filter.firstName||"")+" "+(this.filter.lastName||"")+" "+(this.filter.date||""),per_page:((m=this.options)==null?void 0:m.itemsPerPage)||10,page:((h=this.options)==null?void 0:h.page)||1}):this.apiSelected=="Member tree"?(t="/api/member-tree/search-person",s={name:(this.filter.firstName||"")+" "+(this.filter.lastName||"")+" "+(this.filter.date||"")}):this.apiSelected=="Family search"?(t="/api/family-search/search",s={givenName:this.filter.firstName||"",surname:this.filter.lastName||"",count:((p=this.options)==null?void 0:p.itemsPerPage)||10,offset:((((u=this.options)==null?void 0:u.page)||1)-1)*(((f=this.options)==null?void 0:f.itemsPerPage)||10)}):this.apiSelected=="Wikitree"&&(t="/api/wikitree/search-person",s={FirstName:this.filter.firstName||"",LastName:this.filter.lastName||"",per_page:((v=this.options)==null?void 0:v.itemsPerPage)||10,page:((y=this.options)==null?void 0:y.page)||1}),this.$axios.get(t,{params:s}).then(({data:_})=>{this.apiSelected=="Member tree"?(this.result=_,this.totalCount=_.length):(this.result=_.response.docs,this.totalCount=_.response.number_found),this.loading=!1}).catch(this.errorHandler)}},created(){this.getCompanies()}},ke={class:"columns is-gapless is-multiline is-mobile"},Ce={class:"column is-12"},Pe={class:"is-size-4 has-text-black"},ze={class:"has-text-weight-medium"},Se=e("span",{class:"has-text-weight-light"}," Welcome Back!",-1),Ne=e("div",{class:"column is-12"},[e("nav",{class:"breadcrumb mt-1 mb-0","aria-label":"breadcrumbs"},[e("ul",null,[e("li",null,[e("a",{class:"is-size-7 has-text-weight-medium has-text-link",href:"/dashboard"},"Home")]),e("li",{class:"is-size-7 has-text-weight-medium is-active"},[e("a",{href:"/dashboard","aria-current":"page"},"Dashboard")])])])],-1),Ie={class:"columns mt-3 is-variable is-3 is-desktop"},Ve={class:"column"},De={class:"card has-background-white has-text-black"},Ue={class:"card-content is-flex jc--sb"},je=e("img",{src:be,alt:"",class:"dash-icon"},null,-1),Oe={class:"has-text-right"},Le={class:"is-size-4 has-text-weight-semibold"},Te={class:"is-size-7 has-text-black has-text-weight-medium mt-1"},Me={class:"column"},Fe={class:"card has-background-white has-text-black"},Re={class:"card-content is-flex jc--sb"},Ae=e("img",{src:xe,alt:"",class:"dash-icon"},null,-1),He={class:"has-text-right"},Be={class:"is-size-4 has-text-weight-semibold"},Ee=e("div",{class:"is-size-7 has-text-black has-text-weight-medium mt-1"}," Families Joined ",-1),We={class:"column"},Ge={class:"card has-background-white has-text-black"},qe={class:"card-content is-flex jc--sb"},Je=e("img",{src:ye,alt:"",class:"dash-icon"},null,-1),Ke={class:"has-text-right"},Ye={class:"is-size-4 has-text-weight-semibold"},Qe=e("div",{class:"is-size-7 has-text-black has-text-weight-medium mt-1"}," Peoples Attached ",-1),Ze={class:"columns is-variable"},Xe={class:"column is-4-desktop is-6-tablet is-flex"},$e=e("div",{class:"column is-4-desktop is-6-tablet is-flex"},[e("div",{class:"card w-100 has-background-white has-text-black"},[e("div",{class:"card-header"},[e("div",{class:"card-header-title has-text-black"},"Activity")]),e("div",{class:"card-content"},[e("div",{class:"card_list is-flex"},[e("div",{class:"icon_box is-flex jc--c ai--c"},[e("i",{class:"fas fa-users has-text-white is-size-6"})]),e("div",{class:"is-flex fd--c ml-3"},[g(" New Column added "),e("span",{class:"is-size-7 has-text-dark has-text-weight-regular mt-1"}," on 15th Sep, 2020 at 23:20 pm ")])]),e("div",{class:"card_list is-flex"},[e("div",{class:"icon_box is-flex jc--c ai--c"},[e("i",{class:"fas fa-lock has-text-white is-size-6"})]),e("div",{class:"is-flex fd--c ml-3"},[g(" Password Changed "),e("span",{class:"is-size-7 has-text-dark has-text-weight-regular mt-1"}," on 15th Sep, 2020 at 23:20 pm ")])])])])],-1),es=e("div",{class:"column is-4-desktop is-6-tablet is-flex"},[e("div",{class:"card w-100 has-background-white has-text-black"},[e("div",{class:"card-header"},[e("div",{class:"card-header-title has-text-black"},"Files")]),e("div",{class:"card-content"},[e("div",{class:"card_list is-flex"},[e("div",{class:"icon_box is-flex jc--c ai--c"},[e("i",{class:"fas fa-file-excel has-text-white is-size-6"})]),e("div",{class:"is-flex fd--c ml-3"},[g(" File_22012020.xlsx "),e("span",{class:"is-size-7 has-text-dark has-text-weight-regular mt-1"}," on 15th Sep, 2020 at 23:20 pm ")])]),e("div",{class:"card_list is-flex"},[e("div",{class:"icon_box is-flex jc--c ai--c"},[e("i",{class:"fas fa-file-excel has-text-white is-size-6"})]),e("div",{class:"is-flex fd--c ml-3"},[g(" Tree_Table_Report.xlsx "),e("span",{class:"is-size-7 has-text-dark has-text-weight-regular mt-1"}," on 15th Sep, 2020 at 23:20 pm ")])])])])],-1),ss={class:"columns is-variable is-flex-desktop-only ai--s"},ts={class:"column is-4-desktop is-6-tablet is-flex"},as={key:0,class:"card has-background-primary has-text-centered"},is={class:"card-content"},os=e("p",{class:"is-size-7"},"Buy Plan",-1),ls={key:1,class:"card has-background-primary has-text-white"},ns={class:"card-content"},rs=e("p",{class:"is-size-7"},"Your Plan Expires in",-1),cs={class:"is-size-4 mb-2 has-text-weight-medium"},ds=e("p",{class:"is-size-7"}," Upgrade your plan & join nearly 100 people who have already registered. ",-1),hs={class:"column is-4-desktop is-6-tablet is-flex"},ps={class:"card w-100 has-background-white has-text-black"},us={class:"card-content has-text-centered py-5"},ms={key:0,class:"notification is-success"},fs={key:1,class:"notification is-danger"},_s=e("label",null,"Select Company",-1),vs={class:"is-size-7 mb-2 has-text-weight-medium"},gs={class:"is-size-7 mb-4 has-text-weight-medium"},bs=e("p",{class:"is-size-7 is-uppercase"},"Use Tree",-1),xs={class:"column is-4-desktop is-6-tablet is-flex"},ys={class:"card w-100 has-background-white has-text-black"},ws={class:"card-content has-text-centered py-5"},ks={key:0,class:"notification is-success"},Cs={key:1,class:"notification is-danger"},Ps=e("label",null,"Invited Company",-1),zs={class:"is-size-7 mb-2 has-text-weight-medium"},Ss={class:"is-size-7 mb-4 has-text-weight-medium"},Ns=e("p",{class:"is-size-7 is-uppercase"},"Use Tree",-1);function Is(t,s,n,d,a,o){const m=c("loading"),h=c("v-card-title"),p=c("v-select"),u=c("v-col"),f=c("v-text-field"),v=c("v-date-picker"),y=c("v-menu"),_=c("v-btn"),b=c("v-row"),P=c("v-toolbar"),w=c("v-data-table"),N=c("v-card"),C=J,V=c("chart-card"),U=c("vue-select"),j=c("font-awesome-icon"),G=c("v-app");return k(),A(G,null,{default:r(()=>[i(m,{active:a.isLoading,color:a.color,"background-color":a.backgroundColor},null,8,["active","color","background-color"]),e("div",ke,[e("div",Ce,[e("h1",Pe,[e("span",ze,"Hi "+x(t.loggedInUser.person.name),1),g(", "),Se])]),Ne]),i(N,{outlined:"",shaped:""},{default:r(()=>[i(h,null,{default:r(()=>[g("Search")]),_:1}),i(P,{flat:""},{default:r(()=>[i(b,null,{default:r(()=>[i(u,null,{default:r(()=>[i(p,{modelValue:a.apiSelected,"onUpdate:modelValue":s[0]||(s[0]=l=>a.apiSelected=l),items:a.apiList,label:"API","hide-details":"true"},null,8,["modelValue","items"])]),_:1}),i(u,null,{default:r(()=>[i(f,{label:"First name","hide-details":"true",modelValue:a.filter.firstName,"onUpdate:modelValue":s[1]||(s[1]=l=>a.filter.firstName=l)},null,8,["modelValue"])]),_:1}),i(u,null,{default:r(()=>[i(f,{label:"Last name","hide-details":"true",modelValue:a.filter.lastName,"onUpdate:modelValue":s[2]||(s[2]=l=>a.filter.lastName=l)},null,8,["modelValue"])]),_:1}),i(u,null,{default:r(()=>[i(y,{modelValue:a.dateMenu,"onUpdate:modelValue":s[6]||(s[6]=l=>a.dateMenu=l),"close-on-content-click":!1,"nudge-right":40,transition:"scale-transition","offset-y":""},{activator:r(({on:l})=>[i(f,ae({modelValue:a.filter.date,"onUpdate:modelValue":s[3]||(s[3]=q=>a.filter.date=q),label:"Date",readonly:""},ie(l)),null,16,["modelValue"])]),default:r(()=>[i(v,{modelValue:a.filter.date,"onUpdate:modelValue":s[4]||(s[4]=l=>a.filter.date=l),onInput:s[5]||(s[5]=l=>a.dateMenu=!1)},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),i(u,null,{default:r(()=>[i(_,{onClick:o.search,block:""},{default:r(()=>[g("Search")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1}),i(w,{headers:o.headers,items:a.result||[],options:a.options,"server-items-length":a.totalCount,loading:t.loading,class:"elevation-1"},null,8,["headers","items","options","server-items-length","loading"])]),_:1}),e("div",Ie,[e("div",Ve,[e("div",De,[e("div",Ue,[je,e("div",Oe,[e("p",Le,x(a.peoplesattached),1),e("div",Te,[i(C,{to:"/gedcom",class:"button is-size-7 is-uppercase has-text-weight-medium has-text-primary is-light mt-4"},{default:r(()=>[g("GEDCOM Import ")]),_:1})])])])])]),e("div",Me,[e("div",Fe,[e("div",Re,[Ae,e("div",He,[e("p",Be,x(a.familiesjoined),1),Ee])])])]),e("div",We,[e("div",Ge,[e("div",qe,[Je,e("div",Ke,[e("p",Ye,x(a.peoplesattached),1),Qe])])])])]),e("div",Ze,[e("div",Xe,[i(V,{class:"is-rounded w-100 raises-on-hover has-background-white has-text-black has-margin-bottom-large",source:"/api/dashboard/pie"})]),$e,es]),e("div",ss,[e("div",ts,[t.loggedInUser.role.name=="free"?(k(),z("div",as,[e("div",is,[os,i(C,{to:"/subscription",class:"button is-size-7 is-uppercase has-text-weight-medium has-text-primary is-light mt-4"},{default:r(()=>[g("Subscribe")]),_:1})])])):(k(),z("div",ls,[e("div",ns,[rs,e("p",cs,x(a.trial?a.trial.days:"")+" Days ",1),ds,i(C,{to:"subscription",class:"button is-size-7 is-uppercase has-background-white has-text-weight-medium has-text-primary is-light mt-4"},{default:r(()=>[g("Upgrade Plan ")]),_:1})])]))]),e("div",hs,[e("div",ps,[e("div",us,[a.changedb==!0?(k(),z("div",ms," Changed Tree successfully! ")):I("",!0),a.changedb==!1?(k(),z("div",fs," Somthing Wrong! ")):I("",!0),_s,i(U,{label:"name",modelValue:a.selected_company,"onUpdate:modelValue":s[7]||(s[7]=l=>a.selected_company=l),reduce:l=>l.id,options:a.companies,onInput:o.setSelected},null,8,["modelValue","reduce","options","onInput"]),i(j,{icon:["fas","user-circle"],class:"has-text-primary mb-5 mt-2",style:{"font-size":"55px"}}),e("p",vs,x(t.loggedInUser.email),1),e("p",gs,x(t.loggedInUser.person.name),1),bs])])]),e("div",xs,[e("div",ys,[e("div",ws,[a.changedb==!0?(k(),z("div",ks," Changed Tree successfully! ")):I("",!0),a.changedb==!1?(k(),z("div",Cs," Somthing Wrong! ")):I("",!0),Ps,i(U,{label:"name",modelValue:a.invited_company,"onUpdate:modelValue":s[8]||(s[8]=l=>a.invited_company=l),reduce:l=>l.id,options:a.invited_companies,onInput:o.setSelected},null,8,["modelValue","reduce","options","onInput"]),i(j,{icon:["fas","user-circle"],class:"has-text-primary mb-5 mt-2",style:{"font-size":"55px"}}),e("p",zs,x(t.loggedInUser.email),1),e("p",Ss,x(t.loggedInUser.person.name),1),Ns])])])])]),_:1})}const Rs=R(we,[["render",Is]]);export{Rs as default};
