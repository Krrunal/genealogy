import{al as T,bc as Y,a as X,l as q,dc as J,dd as K,A as Q,s as Z,k as tt,L as et,w as N,r as at,o as h,b as m,e as n,t as b,h as y,z as $,y as x,H as rt,F as it,x as nt,br as st,c as ot,G as ct}from"./entry.92cc3846.js";function lt(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var D=lt,dt=typeof T=="object"&&T&&T.Object===Object&&T,ft=dt,ut=ft,ht=typeof self=="object"&&self&&self.Object===Object&&self,mt=ut||ht||Function("return this")(),M=mt,bt=M,gt=function(){return bt.Date.now()},vt=gt,yt=/\s/;function pt(t){for(var e=t.length;e--&&yt.test(t.charAt(e)););return e}var _t=pt,Tt=_t,$t=/^\s+/;function kt(t){return t&&t.slice(0,Tt(t)+1).replace($t,"")}var jt=kt,St=M,xt=St.Symbol,R=xt,w=R,W=Object.prototype,Ot=W.hasOwnProperty,Ct=W.toString,p=w?w.toStringTag:void 0;function At(t){var e=Ot.call(t,p),s=t[p];try{t[p]=void 0;var c=!0}catch{}var d=Ct.call(t);return c&&(e?t[p]=s:delete t[p]),d}var It=At,Et=Object.prototype,Nt=Et.toString;function wt(t){return Nt.call(t)}var Ht=wt,H=R,Gt=It,Lt=Ht,Bt="[object Null]",Ft="[object Undefined]",G=H?H.toStringTag:void 0;function Dt(t){return t==null?t===void 0?Ft:Bt:G&&G in Object(t)?Gt(t):Lt(t)}var Mt=Dt;function Rt(t){return t!=null&&typeof t=="object"}var Wt=Rt,Pt=Mt,Vt=Wt,zt="[object Symbol]";function Ut(t){return typeof t=="symbol"||Vt(t)&&Pt(t)==zt}var Yt=Ut,Xt=jt,L=D,qt=Yt,B=0/0,Jt=/^[-+]0x[0-9a-f]+$/i,Kt=/^0b[01]+$/i,Qt=/^0o[0-7]+$/i,Zt=parseInt;function te(t){if(typeof t=="number")return t;if(qt(t))return B;if(L(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=L(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Xt(t);var s=Kt.test(t);return s||Qt.test(t)?Zt(t.slice(2),s?2:8):Jt.test(t)?B:+t}var ee=te,ae=D,O=vt,F=ee,re="Expected a function",ie=Math.max,ne=Math.min;function se(t,e,s){var c,d,r,o,a,l,u=0,C=!1,g=!1,k=!0;if(typeof t!="function")throw new TypeError(re);e=F(e)||0,ae(s)&&(C=!!s.leading,g="maxWait"in s,r=g?ie(F(s.maxWait)||0,e):r,k="trailing"in s?!!s.trailing:k);function j(i){var f=c,v=d;return c=d=void 0,u=i,o=t.apply(v,f),o}function P(i){return u=i,a=setTimeout(_,e),C?j(i):o}function V(i){var f=i-l,v=i-u,E=e-f;return g?ne(E,r-v):E}function A(i){var f=i-l,v=i-u;return l===void 0||f>=e||f<0||g&&v>=r}function _(){var i=O();if(A(i))return I(i);a=setTimeout(_,V(i))}function I(i){return a=void 0,k&&c?j(i):(c=d=void 0,o)}function z(){a!==void 0&&clearTimeout(a),u=0,c=l=d=a=void 0}function U(){return a===void 0?o:I(O())}function S(){var i=O(),f=A(i);if(c=arguments,d=this,l=i,f){if(a===void 0)return P(l);if(g)return clearTimeout(a),a=setTimeout(_,e),j(l)}return a===void 0&&(a=setTimeout(_,e)),o}return S.cancel=z,S.flush=U,S}var oe=se;const ce=Y(oe);q.add(J,K,Q,Z,tt,et);const le={meta:{breadcrumb:"notifications",title:"Notifications"},inject:["errorHandler","i18n","route","routerErrorHandler"],data:()=>({paginate:200,notifications:[],offset:0,loading:!1}),computed:{...N(["user","meta"]),...N("layout",["isTouch"])},created(){this.fetch=ce(this.fetch,500),this.fetch()},methods:{fetch(){this.loading||(this.loading=!0,this.$axios.get(this.route("core.notifications.index"),{params:{offset:this.offset,paginate:this.paginate}}).then(({data:t})=>{this.notifications=this.offset?this.notifications.concat(t):t,this.offset=this.notifications.length,this.loading=!1}).catch(this.errorHandler))},read(t){this.$axios.patch(this.route("core.notifications.read",t.id)).then(({data:e})=>{t.read_at=e.read_at,this.$root.$emit("read-notification",t),t.data.path&&t.data.path!=="#"&&this.$router.push({path:t.data.path}).catch(this.routerErrorHandler)}).catch(this.errorHandler)},readAll(){this.$axios.post(this.route("core.notifications.readAll")).then(()=>this.updateAll()).catch(this.errorHandler)},updateAll(){this.notifications.forEach(t=>{t.read_at=t.read_at||this.$format(new Date,"Y-MM-DD H:mm:s")}),this.unreadCount=0,this.$root.$emit("read-all-notifications")},destroyAll(){this.$axios.delete(this.route("core.notifications.destroyAll")).then(()=>{this.notifications=[],this.$root.$emit("destroy-all-notifications")}).catch(this.errorHandler)},destroy(t,e){this.$axios.delete(this.route("core.notifications.destroy",t.id)).then(()=>{this.notifications.splice(e,1),this.$root.$emit("destroy-notification",t)}).catch(this.errorHandler)},timeFromNow(t){return this.$formatDistance(t)}}},de={class:"columns is-centered"},fe={class:"column is-two-thirds-desktop"},ue={class:"level is-mobile"},he={key:0,class:"level-item"},me={class:"icon is-small"},be={class:"level-item"},ge={class:"icon is-small"},ve={key:1,class:"level-item is-marginless"},ye={class:"icon is-small"},pe=["onClick"],_e={class:"is-pulled-right"},Te={class:"icon is-small"},$e=["onClick"],ke=n("span",{class:"is-clearfix"},null,-1),je={key:0,class:"title is-5 has-text-centered"};function Se(t,e,s,c,d,r){const o=at("fa");return h(),m("div",de,[n("div",fe,[n("div",ue,[t.notifications.length?(h(),m("div",he,[n("a",{class:"button is-success is-outlined",onClick:e[0]||(e[0]=(...a)=>r.readAll&&r.readAll(...a))},[n("span",null,b(r.i18n("Mark all read")),1),n("span",me,[y(o,{icon:"check"})])])])):$("",!0),n("div",be,[n("a",{class:x(["button animated fadeIn",{"is-loading":t.loading}]),onClick:e[1]||(e[1]=(...a)=>r.fetch&&r.fetch(...a))},[n("span",null,b(r.i18n("Reload")),1),n("span",ge,[y(o,{icon:"sync"})])],2)]),t.notifications.length?(h(),m("div",ve,[n("a",{class:"button is-warning is-outlined ml-1",onClick:e[2]||(e[2]=(...a)=>r.destroyAll&&r.destroyAll(...a))},[n("span",null,b(r.i18n("Clear all")),1),n("span",ye,[y(o,{icon:"trash-alt"})])])])):$("",!0)]),y(st,{tag:"ul","enter-active-class":"fadeIn","leave-active-class":"fadeOut"},{default:rt(()=>[(h(!0),m(it,null,nt(t.notifications,(a,l)=>(h(),m("li",{class:"animated",key:a.id},[n("div",{class:x(["box has-background-light p-2 mb-1",{"is-bold":!a.read_at}])},[a.data.icon?(h(),ot(o,{key:0,icon:a.data.icon},null,8,["icon"])):$("",!0),n("span",{class:x(["is-clickable",{"has-text-info":a.data.path&&a.data.path!=="#"}]),onClick:u=>r.read(a)},b(a.data.body),11,pe),n("span",_e,[n("span",Te,[y(o,{icon:"clock",size:"xs"})]),ct(" "+b(r.timeFromNow(a.created_at))+" ",1),n("a",{class:"delete ml-2 is-medium",onClick:u=>r.destroy(a,l)},null,8,$e)]),ke],2)]))),128))]),_:1}),!t.loading&&!t.notifications.length?(h(),m("h4",je,b(r.i18n("You don't have any notifications")),1)):$("",!0)])])}const Oe=X(le,[["render",Se]]);export{Oe as default};
