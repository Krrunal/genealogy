import{a as C,l as k,M as K,s as x,aL as V,w as y,r as h,S as _,o as a,b as o,e as s,h as d,t as n,G as c,z as r,O as v,P as p,b8 as b,y as O,F as q,x as S,bq as H,X as I,Y as M}from"./entry.92cc3846.js";import{f as N}from"./focus.3e4288bb.js";import{s as D}from"./selectOnFocus.6b9dd492.js";import"./VueSelect.b511f2f3.js";import{E as B}from"./EnsoSelect.8229d59e.js";import"./SearchMode.06b93769.js";k.add(K,x);const U={meta:{breadcrumb:"edit texts",title:"Edit Texts"},inject:["canAccess","errorHandler","i18n","route","toastr"],directives:{focus:N,selectOnFocus:D},components:{EnsoSelect:B,VueSwitch:V},data:()=>({langFile:{},originalLangFile:{},locales:[],selectedLocale:null,query:null,boxHeight:0,loading:!1,filterMissing:!1,filterCore:!0}),computed:{...y("layout",["isMobile"]),...y(["meta"]),styleObject(){return{"max-height":this.boxHeight,"overflow-y":"auto","overflow-x":"hidden"}},langKeys(){return this.filterMissing?Object.keys(this.originalLangFile).filter(e=>!this.originalLangFile[e]):Object.keys(this.langFile)},filteredKeys(){if(!this.query)return this.sortedKeys();const e=this.query.toLowerCase();return this.langKeys.filter(t=>t.toLowerCase().indexOf(e)>-1||this.langFile[t]&&this.langFile[t].toLowerCase().indexOf(e)>-1)},isNewKey(){return this.selectedLocale&&this.query&&this.filteredKeys.indexOf(this.query)===-1},keysCount(){return this.langKeys.length},subDir(){return this.filterCore?"app":"enso"}},watch:{isMobile:{handler:"setBoxHeight"},filterCore:{handler:"getLangFile"}},created(){this.init(),this.setBoxHeight()},methods:{init(){this.loading=!0,this.$axios.get(this.route("system.localisation.editTexts")).then(({data:e})=>{this.loading=!1,this.locales=e}).catch(this.errorHandler)},getLangFile(){if(!this.selectedLocale){this.langFile={},this.updateOriginal();return}this.loading=!0,this.$axios.get(this.route("system.localisation.getLangFile",{subDir:this.subDir,language:this.selectedLocale})).then(({data:e})=>{this.loading=!1,this.langFile=e,this.updateOriginal()}).catch(this.errorHandler)},saveLangFile(){this.loading=!0,this.$axios.patch(this.route("system.localisation.saveLangFile",{subDir:this.subDir,language:this.selectedLocale}),{langFile:this.langFile}).then(({data:e})=>{this.loading=!1,this.toastr.success(e.message)}).catch(this.errorHandler)},addKey(){this.$set(this.langFile,this.query,null),this.updateOriginal(),this.focusIt()},removeKey(e){this.$delete(this.langFile,e),this.updateOriginal()},focusIt(e=null){e=e||this.query,this.$nextTick(()=>{document.getElementById(e).focus()})},setBoxHeight(){this.boxHeight=document.body.clientHeight-(this.isMobile?420:388)},updateOriginal(){this.originalLangFile=JSON.parse(JSON.stringify(this.langFile))},merge(){this.$axios.patch(this.route("system.localisation.merge")).then(({data:e})=>{this.loading=!1,this.toastr.success(e.message)}).catch(this.errorHandler)},sortedKeys(){return this.langKeys.sort((e,t)=>e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0)}}},T=e=>(I("data-v-6f48f7e3"),e=e(),M(),e),j={class:"wrapper"},z={class:"columns is-multiline"},A={class:"column"},E={class:"columns is-multiline"},J={class:"column is-half"},G={key:0,class:"column is-half has-text-right animated fadeIn is-hidden-mobile"},P={class:"pt-1"},X={key:1,class:"column animated fadeIn"},Y={class:"field"},Q={class:"control has-icons-left has-icons-right"},R=["placeholder"],W={class:"icon is-small is-left"},Z=T(()=>s("a",{class:"delete is-small"},null,-1)),$=[Z],ee={class:"column"},se={class:"columns is-mobile has-text-centered"},te={key:0,class:"column is-half"},ie={key:1,class:"column is-half"},le={key:2,class:"column is-half"},ae={key:0,class:"columns is-mobile has-text-right"},oe={class:"column"},ne={class:"label"},re={class:"column"},de={class:"label"},ce={key:0,class:"box has-background-light raises-on-hover mt-3"},ue={key:0,class:"columns is-hidden-mobile has-shadow-bottom"},he={class:"column is-half has-text-centered"},ge={class:"title is-6"},me={class:"column is-half has-text-centered"},fe={class:"title is-6"},ye={key:1,class:"has-text-centered"},_e={class:"subtitle is-5"},ve={class:"column is-half"},pe=["value"],be={class:"column is-half"},Le={class:"field has-addons"},Fe={class:"control is-expanded"},we=["onUpdate:modelValue","id"],Ce={class:"control"},ke=["onClick"],Ke={class:"icon is-small"};function xe(e,t,Ve,Oe,qe,i){const L=h("enso-select"),g=h("fa"),m=h("vue-switch"),F=_("focus"),f=_("select-on-focus");return a(),o("div",j,[s("div",z,[s("div",A,[s("div",E,[s("div",J,[d(L,{options:e.locales,modelValue:e.selectedLocale,"onUpdate:modelValue":t[0]||(t[0]=l=>e.selectedLocale=l),onInput:t[1]||(t[1]=l=>i.getLangFile()),placeholder:i.i18n("Choose language")},null,8,["options","modelValue","placeholder"])]),e.selectedLocale?(a(),o("div",G,[s("p",P,[s("b",null,n(i.keysCount),1),c(" "+n(i.i18n("keys found")),1)])])):r("",!0),e.selectedLocale?(a(),o("div",X,[s("div",Y,[s("p",Q,[v(s("input",{type:"text",class:"input is-rounded",placeholder:i.i18n("Search"),"onUpdate:modelValue":t[2]||(t[2]=l=>e.query=l),onKeyup:t[3]||(t[3]=b(l=>i.isNewKey?i.addKey():i.focusIt(null),["enter"]))},null,40,R),[[F],[f],[p,e.query]]),s("span",W,[d(g,{icon:"search"})]),e.query?(a(),o("span",{key:0,class:"icon is-small is-right clear-button",onClick:t[4]||(t[4]=l=>e.query=null)},$)):r("",!0)])])])):r("",!0)])]),s("div",ee,[s("div",se,[e.selectedLocale?(a(),o("div",te,[i.isNewKey?(a(),o("button",{key:0,class:"button is-success is-fullwidth",onClick:t[5]||(t[5]=l=>i.addKey())},n(i.i18n("Add Key")),1)):r("",!0)])):r("",!0),!e.selectedLocale&&e.meta.env==="local"?(a(),o("div",ie,[i.canAccess("system.localisation.merge")?(a(),o("button",{key:0,class:"button is-warning",onClick:t[6]||(t[6]=l=>i.merge())},n(i.i18n("Merge all localisation files")),1)):r("",!0)])):r("",!0),e.selectedLocale?(a(),o("div",le,[s("button",{onClick:t[7]||(t[7]=l=>i.saveLangFile()),class:O(["button is-success is-fullwidth",{"is-loading":e.loading}])},n(i.i18n("Update")),3)])):r("",!0)]),e.selectedLocale?(a(),o("div",ae,[s("div",oe,[s("label",ne,[c(n(i.i18n("Core"))+" ",1),d(m,{class:"mx-2",modelValue:e.filterCore,"onUpdate:modelValue":t[8]||(t[8]=l=>e.filterCore=l),size:"is-large"},null,8,["modelValue"]),c(" "+n(i.i18n("App")),1)])]),s("div",re,[s("label",de,[c(n(i.i18n("Only missing"))+" ",1),d(m,{class:"ml-2",modelValue:e.filterMissing,"onUpdate:modelValue":t[9]||(t[9]=l=>e.filterMissing=l),size:"is-large"},null,8,["modelValue"])])])])):r("",!0)])]),e.selectedLocale?(a(),o("div",ce,[i.filteredKeys.length?(a(),o("div",ue,[s("div",he,[s("h6",ge,n(i.i18n("Key")),1)]),s("div",me,[s("h6",fe,n(i.i18n("Value")),1)])])):(a(),o("div",ye,[s("h5",_e,n(i.i18n("No keys found")),1)])),s("div",{style:H(i.styleObject)},[(a(!0),o(q,null,S(i.filteredKeys,(l,w)=>(a(),o("div",{class:"columns",key:w},[s("div",ve,[s("input",{type:"text",class:"input",readonly:"",value:l},null,8,pe)]),s("div",be,[s("div",Le,[s("p",Fe,[v(s("input",{type:"text","onUpdate:modelValue":u=>e.langFile[l]=u,id:l,class:"input",onKeyup:t[10]||(t[10]=b(u=>i.focusIt("search-input"),["enter"]))},null,40,we),[[f],[p,e.langFile[l]]])]),s("p",Ce,[s("a",{class:"button is-outlined is-danger",onClick:u=>i.removeKey(l)},[s("span",Ke,[d(g,{icon:"trash-alt"})])],8,ke)])])])]))),128))],4)])):r("",!0)])}const Be=C(U,[["render",xe],["__scopeId","data-v-6f48f7e3"]]);export{Be as default};
