import{a as v,V as $,T as q,r as u,S as k,o as i,b as n,F as C,x as w,O as y,c as S,y as x,l as T,f as I,q as A,U as L,A as N,W as B,e as a,P as V,t as _,h as d,z as m,H,p as z,M as D,k as j,G as F,X as U,Y as E}from"./entry.92cc3846.js";import{f as M}from"./focus.3e4288bb.js";import"./VueSelect.b511f2f3.js";import{E as O}from"./EnsoSelect.8229d59e.js";import"./SearchMode.06b93769.js";const P={name:"AvatarList",directives:{tooltip:$},components:{Avatar:q},inject:["route"],props:{users:{type:Array,required:!0},isSmall:{type:Boolean,default:!1}}},G={class:"is-flex avatar-list"};function W(e,s,t,b,g,l){const r=u("avatar"),h=k("tooltip");return i(),n("div",G,[(i(!0),n(C,null,w(t.users,o=>y((i(),S(r,{class:x(["image mr-1 mb-1",t.isSmall?"is-24x24":"is-32x32"]),key:o.id,user:o},null,8,["class","user"])),[[h,o.name]])),128))])}const X=v(P,[["render",W]]);T.add([I,A,L,N]);const Y={name:"Team",inject:["errorHandler","i18n","route","toastr"],directives:{focus:M},components:{Fade:B,EnsoSelect:O,AvatarList:X},props:{team:{type:Object,required:!0}},data:()=>({loading:!1}),methods:{store(){this.loading=!0,this.$axios.post(this.route("administration.teams.store"),this.team).then(({data:e})=>{this.loading=!1,this.toastr.success(e.message),this.team.users=e.team.users,this.team.id=e.team.id,this.team.edit=!1,this.$emit("create",this.team)}).catch(e=>{if(e.response.status===422){this.toastr.warning(this.i18n("Choose another name"));return}this.errorHandler(e)})},destroy(){this.loading=!0,this.$axios.delete(this.route("administration.teams.destroy",this.team.id)).then(({data:e})=>{this.loading=!1,this.toastr.success(e.message),this.team.edit=!1,this.$emit("destroy")}).catch(this.errorHandler)}}},J={class:"box-header p-2 has-background-light"},K={class:"level is-mobile"},Q={class:"level-left"},R={name:"left",class:"level-item ml-1"},Z={class:"label"},ee={key:1},se={class:"level-right"},te={class:"level-item has-text-right"},ae={class:"icon"},ie={key:1,class:"animated fadeIn"},ne={class:"icon"},oe=["disabled"],le={class:"icon"},de={class:"icon"},re={class:"box-body p-2"},ce={key:0,class:"has-text-muted is-italic mb-1"},me={key:0,class:"mb-3 mt-3"},ue={class:"label"};function he(e,s,t,b,g,l){const r=u("fa"),h=u("avatar-list"),o=u("enso-select"),f=u("fade"),p=k("focus");return i(),n("div",{class:x(["box info-box is-paddingless raises-on-hover",[{"is-danger":t.team.edit&&!t.team.id},{"is-warning":t.team.edit&&t.team.id},{"is-info":!t.team.edit&&t.team.users.length===0}]])},[a("div",J,[a("div",K,[a("div",Q,[a("div",R,[a("label",Z,[t.team.edit?y((i(),n("input",{key:0,class:"input team-name","onUpdate:modelValue":s[0]||(s[0]=c=>t.team.name=c)},null,512)),[[V,t.team.name],[p]]):(i(),n("span",ee,_(t.team.name),1))])])]),a("div",se,[a("div",te,[t.team.edit?(i(),n("span",ie,[a("a",{class:"button is-naked is-outlined",onClick:s[2]||(s[2]=c=>{e.$emit("cancel"),t.team.edit=!1})},[a("span",ne,[d(r,{icon:"ban"})])]),a("a",{class:"button is-naked is-success is-outlined",disabled:!t.team.name,onClick:s[3]||(s[3]=c=>{l.store()})},[a("span",le,[d(r,{icon:"check",size:"sm"})])],8,oe),t.team.id!==null?(i(),n("a",{key:0,class:"button is-naked is-danger is-outlined",onClick:s[4]||(s[4]=(...c)=>l.destroy&&l.destroy(...c))},[a("span",de,[d(r,{icon:"trash"})])])):m("",!0)])):(i(),n("a",{key:0,class:"button is-naked animated fadeIn",onClick:s[1]||(s[1]=c=>t.team.edit=!0)},[a("span",ae,[d(r,{icon:"pencil-alt",size:"sm"})])]))])])])]),a("div",re,[d(h,{users:t.team.users},null,8,["users"]),!t.team.edit&&!e.loading&&t.team.users.length===0?(i(),n("span",ce,_(l.i18n("No users yet")),1)):m("",!0),d(f,null,{default:H(()=>[t.team.edit&&t.team.name?(i(),n("div",me,[a("label",ue,_(l.i18n("Members"))+": ",1),d(o,{modelValue:t.team.userIds,"onUpdate:modelValue":s[5]||(s[5]=c=>t.team.userIds=c),multiple:"",source:"administration.users.options",label:"person.name"},null,8,["modelValue"])])):m("",!0)]),_:1})])],2)}const _e=v(Y,[["render",he]]);T.add(z,D,j);const fe={meta:{breadcrumb:"index",title:"Teams"},inject:["errorHandler","i18n","route"],components:{Team:_e},data:()=>({loading:!1,ready:!1,teams:[],team:null,query:null}),computed:{filteredTeams(){return this.query?this.teams.filter(({edit:e,name:s})=>e||s.toLowerCase().indexOf(this.query.toLowerCase())>-1):this.teams}},created(){this.fetch()},methods:{fetch(){this.loading=!0,this.$axios.get(this.route("administration.teams.index")).then(({data:e})=>{this.teams=e,this.loading=!1,this.ready=!0}).catch(this.errorHandler)},factory(){return{id:null,name:null,userIds:[],users:[],edit:!0}}}},ve=e=>(U("data-v-c2e2c307"),e=e(),E(),e),ye={class:"wrapper"},be={key:0},ge=["disabled"],pe={class:"icon is-small"},ke={key:0,class:"control has-icons-left has-icons-right is-pulled-right"},Ce=["placeholder"],we={class:"icon is-small is-left"},xe=ve(()=>a("a",{class:"delete is-small"},null,-1)),Te=[xe],Ve={key:1,class:"title is-4 has-text-centered"},$e={class:"icon is-small ml-2"},qe={key:2,class:"columns is-multiline"},Se={key:0,class:"column is-one-third-widescreen is-half-tablet"},Ie={key:1,class:"column"},Ae={class:"subtitle is-3 has-text-centered"};function Le(e,s,t,b,g,l){const r=u("fa"),h=u("team");return i(),n("div",ye,[e.ready?(i(),n("div",be,[a("button",{class:"button is-success mb-3",onClick:s[0]||(s[0]=o=>e.team=l.factory()),disabled:e.team},[a("span",pe,[d(r,{icon:"plus"})]),a("span",null,_(l.i18n("New team")),1)],8,ge),e.teams.length>3?(i(),n("div",ke,[y(a("input",{class:"team-search input",type:"text",placeholder:l.i18n("Filter teams"),"onUpdate:modelValue":s[1]||(s[1]=o=>e.query=o)},null,8,Ce),[[V,e.query]]),a("span",we,[d(r,{icon:"search"})]),e.query?(i(),n("span",{key:0,class:"icon is-small is-right clear-button",onClick:s[2]||(s[2]=o=>e.query=null)},Te)):m("",!0)])):m("",!0)])):m("",!0),!e.ready&&e.loading?(i(),n("h4",Ve,[F(_(l.i18n("Loading"))+" ",1),a("span",$e,[d(r,{icon:"spinner",size:"xs",spin:""})])])):(i(),n("div",qe,[e.team?(i(),n("div",Se,[d(h,{team:e.team,onCancel:s[3]||(s[3]=o=>e.team=null),onCreate:s[4]||(s[4]=o=>{e.teams.unshift(o),e.team=null})},null,8,["team"])])):m("",!0),(i(!0),n(C,null,w(l.filteredTeams,(o,f)=>(i(),n("div",{class:"column is-one-third-widescreen is-half-tablet",key:f},[d(h,{team:o,onDestroy:p=>e.teams.splice(f,1)},null,8,["team","onDestroy"])]))),128)),e.teams.length===0?(i(),n("div",Ie,[a("h3",Ae,_(l.i18n("No teams were created yet")),1)])):m("",!0)]))])}const je=v(fe,[["render",Le],["__scopeId","data-v-c2e2c307"]]);export{je as default};
